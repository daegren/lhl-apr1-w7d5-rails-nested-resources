# W7D5 - Nested Resources and Namespacing

Hi everyone!

Today we did a review of creating apps with Rails, using the form_for helper, working in an error-driven way, and then took a look at nested resources and namespacing.

[The code for the demo is available here.](https://github.com/daegren/lhl-apr1-w7d5-rails-nested-resources)

## Nested Resources

In short, on nested resources:

We define the nesting in our **routes**. In routes.rb you say:

```rb
 resources :parents do
    resources :children
  end
```

This will generate all the /parents/:parent_id/children/:id routes that you would need. Run `rake routes` to verify this! Note, you don't need to have controllers created, or migrations/models made or anything for this to work. `rake routes` reads the routes folder, generates the routes, and points them to particular places (seen under the ACTIONS column).

The rest of your controller setup is the same as it was before! I.e. you'll need a "children_controller" right next to your "parent_controller". Take a look at how we have the `memes` and `posts` controllers right next to each other (ignore the `mememaster` folder in the controllers for now).

The are some nice helpful path helpers that get generated by this nested resource stuff. If you look at `rake routes`, you'll see the prefixes for these under PREFIX. For example, the path `/parents/5/children` could be generated by calling `parent_children(@parent)`. Take a look at where I do that kind of stuff in the `show.html.erb` view for the posts.

## Namespacing

Namespacing gives us a convenient way to define a bunch of routes that should be preceded by some prefix (e.g. `/admin/...`). We can do this in the routes file:

```rb
  namespace :admin do
    resources :posts
  end
```

The example above will generate a bunch of `/admin/posts/...` routes, and point them to particular actions in the relevant controllers. The controller will need to be defined in an `admin` file, and then they **must** follow this specification:

```rb
# controllers/admin/posts_controller.rb
class Admin::PostsController < ApplicationController
  # do whatever you want in here
end
```

You'll find that you need to redefine the particular actions inside of that new controller, even if you have them somewhere else (e.g. in `controllers/posts_controller.rb`) because the logic for an "admin" might be fundamentally different. You'll also need to make new views under `views/admin/VIEWNAME`, because the views for the admin might be different as well. There _are_ ways of using the standard non-admin views, which involves calling the "render" method. Take a look at the rails guides for that, or reach out to me and I can show you how that works.

Note in `rake routes` that when you do this namespacing stuff you can see all the routes that have been generated! Use that to inform yourself on what controllers and actions need to be created.
